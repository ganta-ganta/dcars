<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>GoPandaCars - Rent Premium Cars</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    .car-card { transition: transform 0.3s; margin-bottom: 20px; }
    .car-card:hover { transform: translateY(-5px); }
    .hero-section { 
      background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('https://source.unsplash.com/random/1200x400/?car,rental');
      background-size: cover;
      color: white;
      padding: 100px 0;
      margin-bottom: 40px;
    }
    .badge-category { font-size: 0.8rem; }
    .nav-link { font-weight: 500; }
    .card-img-top {
      height: 200px;
      object-fit: cover;
    }
  </style>
</head>
<body>
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
    <div class="container">
      <a class="navbar-brand fw-bold" href="#">GoPandaCars</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav me-auto">
          <li class="nav-item"><a class="nav-link active" href="#">Home</a></li>
          <li class="nav-item"><a class="nav-link" href="#economy">Economy</a></li>
          <li class="nav-item"><a class="nav-link" href="#premium">Premium</a></li>
          <li class="nav-item"><a class="nav-link" href="#luxury">Luxury</a></li>
        </ul>
        <div>
          <a href="login.html" class="btn btn-outline-light me-2">Login</a>
          <a href="login.html?action=signup" class="btn btn-primary">Sign Up</a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero-section text-center">
    <div class="container">
      <h1 class="display-4 fw-bold mb-4">Premium Car Rentals</h1>
      <p class="lead mb-5">Choose from our wide range of vehicles for your perfect journey</p>
      <a href="#cars" class="btn btn-primary btn-lg px-4 me-2">Browse Cars</a>
      <a href="login.html" class="btn btn-outline-light btn-lg px-4">Book Now</a>
    </div>
  </section>

  <!-- Cars Section -->
  <div class="container mb-5" id="cars">
    <div class="text-center mb-5">
      <h2 class="fw-bold">Our Fleet</h2>
      <p class="lead text-muted">Select from our premium collection</p>
    </div>

    <!-- Economy Cars -->
    <h3 id="economy" class="mb-4 mt-5">Economy Cars</h3>
    <div class="row g-4 mb-5" id="economyCars"></div>

    <!-- Premium Cars -->
    <h3 id="premium" class="mb-4 mt-5">Premium Cars</h3>
    <div class="row g-4 mb-5" id="premiumCars"></div>

    <!-- Luxury Cars -->
    <h3 id="luxury" class="mb-4 mt-5">Luxury Cars</h3>
    <div class="row g-4" id="luxuryCars"></div>
  </div>

  <!-- Booking Modal -->
  <div class="modal fade" id="bookingModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Book <span id="modalCarName"></span></h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div id="loginRequired" class="text-center py-4">
            <h6>Please login to book this car</h6>
            <a href="login.html" class="btn btn-primary mt-3">Login</a>
          </div>
          <form id="bookingForm" style="display:none;">
            <div class="mb-3">
              <label class="form-label">Rental Option</label>
              <select class="form-select" id="rentalOption">
                <option value="12hrs">12 Hours (₹<span id="price12hrs"></span>)</option>
                <option value="24hrs">24 Hours (₹<span id="price24hrs"></span>)</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">Start Date</label>
              <input type="date" class="form-control" id="startDate" required>
            </div>
            <div class="mb-3">
              <label class="form-label">End Date</label>
              <input type="date" class="form-control" id="endDate" required>
            </div>
            <div class="alert alert-info">
              Estimated Total: ₹<span id="estimatedTotal">0</span>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" id="confirmBookingBtn" class="btn btn-primary" style="display:none;">Confirm Booking</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="bg-dark text-white py-5">
    <div class="container">
      <div class="row">
        <div class="col-md-4 mb-4">
          <h5>GoPandaCars</h5>
          <p>Premium car rental service with the best vehicles and customer service.</p>
        </div>
        <div class="col-md-2 mb-4">
          <h5>Quick Links</h5>
          <ul class="list-unstyled">
            <li><a href="#" class="text-white">Home</a></li>
            <li><a href="#economy" class="text-white">Economy Cars</a></li>
            <li><a href="#premium" class="text-white">Premium Cars</a></li>
            <li><a href="#luxury" class="text-white">Luxury Cars</a></li>
          </ul>
        </div>
        <div class="col-md-3 mb-4">
          <h5>Contact Us</h5>
          <ul class="list-unstyled">
            <li><i class="fas fa-phone me-2"></i> +91 9876543210</li>
            <li><i class="fas fa-envelope me-2"></i> info@gopandacars.com</li>
            <li><i class="fas fa-map-marker-alt me-2"></i> Bangalore, India</li>
          </ul>
        </div>
        <div class="col-md-3 mb-4">
          <h5>Follow Us</h5>
          <div class="social-links">
            <a href="#" class="text-white me-3"><i class="fab fa-facebook-f"></i></a>
            <a href="#" class="text-white me-3"><i class="fab fa-twitter"></i></a>
            <a href="#" class="text-white me-3"><i class="fab fa-instagram"></i></a>
            <a href="#" class="text-white"><i class="fab fa-linkedin-in"></i></a>
          </div>
        </div>
      </div>
      <hr class="my-4 bg-light">
      <div class="text-center">
        <p class="mb-0">&copy; 2023 GoPandaCars. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
  
  <script>
    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyAJKgz1fONteZPPD5T9bcIVjw3-iBUZyro",
      authDomain: "gopandacars-7085f.firebaseapp.com",
      projectId: "gopandacars-7085f",
      storageBucket: "gopandacars-7085f.appspot.com",
      messagingSenderId: "486383420605"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Car data with placeholder images
    const cars = [
    {name: 'Swift', image: 'img/swift.jpg', price12hrs: 1200, price24hrs: 2000, 
     description: 'Compact hatchback with great fuel efficiency and comfortable seating for 5.', category: 'economy'},
     
    {name: 'Etios', image: 'img/etios.jpg', price12hrs: 1200, price24hrs: 2000, 
     description: 'Reliable sedan with spacious interior and good mileage.', category: 'economy'},
     
    {name: 'I10 Nios', image: 'img/i10nios.jpg', price12hrs: 1500, price24hrs: 2300, 
     description: 'Premium hatchback with modern features and stylish design.', category: 'economy'},
     
    {name: 'Swift Dzire', image: 'img/swiftdzire.jpg', price12hrs: 1500, price24hrs: 2300, 
     description: 'Popular compact sedan with excellent ride quality.', category: 'economy'},
     
    {name: 'Hyundai Aura', image: 'img/aura.jpg', price12hrs: 1500, price24hrs: 2500, 
     description: 'Stylish compact sedan with premium features.', category: 'premium'},
     
    {name: 'Tata Punch', image: 'img/punch.jpg', price12hrs: 1500, price24hrs: 2500, 
     description: 'Compact SUV with rugged design and modern features.', category: 'premium'},
     
    {name: 'Hyundai i20', image: 'img/i20.jpg', price12hrs: 1500, price24hrs: 2500, 
     description: 'Premium hatchback with sporty looks and advanced features.', sunroof: true, category: 'premium'},
     
    {name: 'Renault Kiger', image: 'img/kiger.jpg', price12hrs: 1500, price24hrs: 2500, 
     description: 'Compact SUV with bold styling and spacious interior.', category: 'premium'},
     
    {name: 'Urban Cruiser', image: 'img/urban-cruiser.jpg', price12hrs: 1500, price24hrs: 2500, 
     description: 'Compact SUV with Toyota reliability and comfort.', category: 'premium'},
     
    {name: 'Brezza', image: 'img/brezza.jpg', price12hrs: 1500, price24hrs: 2500, 
     description: 'Popular compact SUV with excellent build quality.', category: 'premium'},
     
    {name: 'Nexa Fronx', image: 'img/fronx.jpg', price12hrs: 1500, price24hrs: 2500, 
     description: 'Stylish crossover with premium features.', sunroof: true, category: 'premium'},
     
    {name: 'Hyundai Creta', image: 'img/creta.jpg', price12hrs: 2000, price24hrs: 3000, 
     description: 'Premium SUV with luxurious features and spacious cabin.', category: 'premium'},
     
    {name: 'Grand Vitara', image: 'img/grandvitara.jpg', price12hrs: 2000, price24hrs: 3000, 
     description: 'Premium SUV with hybrid technology and elegant design.', category: 'premium'},
     
    {name: 'Ertiga', image: 'img/ertiga.jpg', price12hrs: 2000, price24hrs: 3500, 
     description: '7-seater MPV with comfortable seating and good mileage.', category: 'premium'},
     
    {name: 'Bolero Neo', image: 'img/bolero-neo.jpg', price12hrs: 2000, price24hrs: 3500, 
     description: 'Rugged SUV with excellent off-road capabilities.', category: 'premium'},
     
    {name: 'Mahindra Thar', image: 'img/thar.jpg', price12hrs: 3500, price24hrs: 5000, 
     description: 'Iconic off-roader with convertible top and powerful engine.', category: 'luxury'},
     
    {name: 'Innova Crysta', image: 'img/innova.jpg', price12hrs: 3500, price24hrs: 5000, 
     description: 'Premium 7-seater MPV with luxurious comfort.',  category: 'luxury'},
     
    {name: 'Brezza Sunroof', image: 'img/brezza-sunroof.jpg', price12hrs: 1500, price24hrs: 2500, 
     description: 'Compact SUV with panoramic sunroof for open-air experience.', sunroof: true, category: 'premium'},
     
    {name: 'Mahindra XUV700', image: 'img/xuv700.jpg', price24hrs: 6500, price12hrs: 4500, 
     description: 'Premium SUV with advanced features and powerful performance.', withDriver: true, category: 'luxury'},
     
    {name: 'Hyundai Venue', image: 'img/venue.jpg', price24hrs: 2500, price12hrs: 1500, 
     description: 'Compact SUV with bold styling and connected car tech.', category: 'premium'},
      {name: 'Baleno',image: 'img/baleno.jpg',price12hrs: 1500,price24hrs: 2500,
    description: 'Mid variant hatchback with comfort, style, and great fuel efficiency.',
    category: 'premium'  },
     
    {name: 'Tata Nexon Sunroof', image: 'img/nexon-sunroof.jpg', price24hrs: 2800, price12hrs: 1800, 
     description: 'Safe and stylish compact SUV with panoramic sunroof.', sunroof: true, category: 'premium'},
     
    {name: 'Tata Altroz Sunroof', image: 'img/altroz-sunroof.jpg', price24hrs: 2500, price12hrs: 1600, 
     description: 'Premium hatchback with sunroof and premium interiors.', sunroof: true, category: 'premium'},
     
    {name: 'XUV 300 Sunroof', image: 'img/xuv300-sunroof.jpg', price24hrs: 2800, price12hrs: 1800, 
     description: 'Feature-packed compact SUV with sunroof option.', sunroof: true, category: 'premium'},
     
    {name: 'Fortuner', image: 'img/fortuner.jpg', price24hrs: 12000, price12hrs: 8000, 
     description: 'Premium full-size SUV with powerful engine and luxury features.', withDriver: true, category: 'luxury'},
     
    {name: 'Kia Seltos', image: 'img/kia-selto.jpg', price24hrs: 2800, price12hrs: 1800, 
     description: 'Stylish SUV with premium features and spacious cabin.', category: 'premium'}
];

    // Initialize Bootstrap modal
    const bookingModal = new bootstrap.Modal(document.getElementById('bookingModal'));
    let selectedCar = null;

    // Function to render cars by category
    function renderCars() {
      const economyCars = cars.filter(car => car.category === 'economy');
      const premiumCars = cars.filter(car => car.category === 'premium');
      const luxuryCars = cars.filter(car => car.category === 'luxury');

      renderCarCategory(economyCars, 'economyCars');
      renderCarCategory(premiumCars, 'premiumCars');
      renderCarCategory(luxuryCars, 'luxuryCars');
    }

    function renderCarCategory(carList, elementId) {
      const container = document.getElementById(elementId);
      container.innerHTML = '';

      carList.forEach((car, index) => {
        const card = document.createElement('div');
        card.className = 'col-md-4';
        card.innerHTML = `
          <div class="card car-card h-100">
            <img src="${car.image}" class="card-img-top" alt="${car.name}" 
                 onerror="this.onerror=null;this.src='https://placehold.co/600x400?text=Car+Image'">
            <div class="card-body">
              <h5 class="card-title">${car.name}</h5>
              <p class="card-text text-muted">${car.description}</p>
              <div class="d-flex justify-content-between align-items-center mb-2">
                <div>
                  <span class="fw-bold">₹${car.price12hrs}</span>/12h
                  <span class="mx-2">•</span>
                  <span class="fw-bold">₹${car.price24hrs}</span>/24h
                </div>
                <span class="badge bg-${getCategoryColor(car.category)} badge-category">${car.category}</span>
              </div>
              ${car.sunroof ? '<span class="badge bg-info me-1">Sunroof</span>' : ''}
              ${car.withDriver ? '<span class="badge bg-warning">With Driver</span>' : ''}
            </div>
            <div class="card-footer bg-transparent">
              <button class="btn btn-primary w-100 book-btn" data-car-index="${index}">Book Now</button>
            </div>
          </div>
        `;
        container.appendChild(card);
      });

      // Add event listeners to book buttons
      document.querySelectorAll('.book-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const carIndex = this.getAttribute('data-car-index');
          showBookingModal(cars[carIndex]);
        });
      });
    }

    function getCategoryColor(category) {
      switch(category) {
        case 'economy': return 'success';
        case 'premium': return 'primary';
        case 'luxury': return 'danger';
        default: return 'secondary';
      }
    }

    function showBookingModal(car) {
      selectedCar = car;
      document.getElementById('modalCarName').textContent = car.name;
      document.getElementById('price12hrs').textContent = car.price12hrs;
      document.getElementById('price24hrs').textContent = car.price24hrs;
      
      // Check if user is logged in
      const user = auth.currentUser;
      if (user) {
        document.getElementById('loginRequired').style.display = 'none';
        document.getElementById('bookingForm').style.display = 'block';
        document.getElementById('confirmBookingBtn').style.display = 'block';
      } else {
        document.getElementById('loginRequired').style.display = 'block';
        document.getElementById('bookingForm').style.display = 'none';
        document.getElementById('confirmBookingBtn').style.display = 'none';
      }
      
      // Set minimum date to today
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('startDate').min = today;
      document.getElementById('endDate').min = today;
      
      updateEstimatedTotal();
      bookingModal.show();
    }

    function updateEstimatedTotal() {
      if (!selectedCar) return;
      
      const option = document.getElementById('rentalOption').value;
      const startDate = new Date(document.getElementById('startDate').value);
      const endDate = new Date(document.getElementById('endDate').value);
      
      if (isNaN(startDate.getTime())) return;
      
      if (isNaN(endDate.getTime())) {
        // Single day booking
        const price = option === '12hrs' ? selectedCar.price12hrs : selectedCar.price24hrs;
        document.getElementById('estimatedTotal').textContent = price;
      } else {
        // Multi-day booking
        const days = Math.ceil((endDate - startDate) / (1000 * 60 * 60 * 24)) + 1;
        const pricePerDay = option === '12hrs' ? selectedCar.price12hrs : selectedCar.price24hrs;
        document.getElementById('estimatedTotal').textContent = days * pricePerDay;
      }
    }

    // Event listeners for booking form
    document.getElementById('rentalOption').addEventListener('change', updateEstimatedTotal);
    document.getElementById('startDate').addEventListener('change', function() {
      document.getElementById('endDate').min = this.value;
      updateEstimatedTotal();
    });
    document.getElementById('endDate').addEventListener('change', updateEstimatedTotal);

    // Confirm booking
    document.getElementById('confirmBookingBtn').addEventListener('click', () => {
      const user = auth.currentUser;
      if (!user) {
        alert('Please login to complete booking');
        return;
      }

      const startDate = document.getElementById('startDate').value;
      const endDate = document.getElementById('endDate').value;
      const option = document.getElementById('rentalOption').value;
      const price = option === '12hrs' ? selectedCar.price12hrs : selectedCar.price24hrs;
      const bookingId = 'BOOK-' + Math.random().toString(36).substr(2, 8).toUpperCase();

      db.collection('bookings').doc(bookingId).set({
        userId: user.uid,
        userEmail: user.email,
        carId: selectedCar.name,
        carImage: selectedCar.image,
        startDate: startDate,
        endDate: endDate,
        rentalOption: option,
        originalPrice: price,
        finalPrice: price, // Initially same as original price
        status: 'pending_payment',
        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
        bookingId: bookingId
      }).then(() => {
        bookingModal.hide();
        window.location.href = `pay.html?bookingId=${bookingId}`;
      }).catch(error => {
        alert('Error submitting booking: ' + error.message);
      });
    });

    // Check auth state to show/hide login prompt
    auth.onAuthStateChanged(user => {
      if (user && document.getElementById('loginRequired').style.display === 'block') {
        document.getElementById('loginRequired').style.display = 'none';
        document.getElementById('bookingForm').style.display = 'block';
        document.getElementById('confirmBookingBtn').style.display = 'block';
      }
    });

    // Initialize the page
    document.addEventListener('DOMContentLoaded', function() {
      renderCars();
    });
  </script>
</body>
</html>
