<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>GoPandaCars - Rent Premium Cars</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    .car-card { transition: transform 0.3s; }
    .car-card:hover { transform: translateY(-5px); }
    .hero-section { 
      background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('img/hero-bg.jpg');
      background-size: cover;
      color: white;
      padding: 100px 0;
      margin-bottom: 40px;
    }
    .badge-category { font-size: 0.8rem; }
    .nav-link { font-weight: 500; }
  </style>
</head>
<body>
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
    <div class="container">
      <a class="navbar-brand fw-bold" href="index.html">GoPandaCars</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav me-auto">
          <li class="nav-item"><a class="nav-link active" href="index.html">Home</a></li>
          <li class="nav-item"><a class="nav-link" href="#economy">Economy</a></li>
          <li class="nav-item"><a class="nav-link" href="#premium">Premium</a></li>
          <li class="nav-item"><a class="nav-link" href="#luxury">Luxury</a></li>
        </ul>
        <div id="authButtons">
          <a href="login.html" class="btn btn-outline-light me-2">Login</a>
          <a href="login.html?action=signup" class="btn btn-primary">Sign Up</a>
        </div>
        <div id="userProfile" style="display:none;">
          <div class="dropdown">
            <button class="btn btn-outline-light dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown">
              <i class="fas fa-user-circle me-1"></i>
              <span id="userName">Profile</span>
            </button>
            <ul class="dropdown-menu dropdown-menu-end">
              <li><a class="dropdown-item" href="profile.html">My Profile</a></li>
              <li><a class="dropdown-item" href="profile.html#bookings">My Bookings</a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" href="#" id="logoutBtn">Logout</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero-section text-center">
    <div class="container">
      <h1 class="display-4 fw-bold mb-4">Premium Car Rentals</h1>
      <p class="lead mb-5">Choose from our wide range of vehicles for your perfect journey</p>
      <a href="#cars" class="btn btn-primary btn-lg px-4 me-2">Browse Cars</a>
      <a href="login.html" class="btn btn-outline-light btn-lg px-4">Book Now</a>
    </div>
  </section>

  <!-- Cars Section -->
  <div class="container mb-5" id="cars">
    <div class="text-center mb-5">
      <h2 class="fw-bold">Our Fleet</h2>
      <p class="lead text-muted">Select from our premium collection</p>
    </div>

    <!-- Economy Cars -->
    <h3 id="economy" class="mb-4 mt-5">Economy Cars</h3>
    <div class="row g-4 mb-5" id="economyCars"></div>

    <!-- Premium Cars -->
    <h3 id="premium" class="mb-4 mt-5">Premium Cars</h3>
    <div class="row g-4 mb-5" id="premiumCars"></div>

    <!-- Luxury Cars -->
    <h3 id="luxury" class="mb-4 mt-5">Luxury Cars</h3>
    <div class="row g-4" id="luxuryCars"></div>
  </div>

  <!-- Footer -->
  <footer class="bg-dark text-white py-5">
    <div class="container">
      <div class="row">
        <div class="col-md-4 mb-4">
          <h5>GoPandaCars</h5>
          <p>Premium car rental service with the best vehicles and customer service.</p>
        </div>
        <div class="col-md-2 mb-4">
          <h5>Quick Links</h5>
          <ul class="list-unstyled">
            <li><a href="index.html" class="text-white">Home</a></li>
            <li><a href="#economy" class="text-white">Economy Cars</a></li>
            <li><a href="#premium" class="text-white">Premium Cars</a></li>
            <li><a href="#luxury" class="text-white">Luxury Cars</a></li>
          </ul>
        </div>
        <div class="col-md-3 mb-4">
          <h5>Contact Us</h5>
          <ul class="list-unstyled">
            <li><i class="fas fa-phone me-2"></i> +91 9876543210</li>
            <li><i class="fas fa-envelope me-2"></i> info@gopandacars.com</li>
            <li><i class="fas fa-map-marker-alt me-2"></i> Bangalore, India</li>
          </ul>
        </div>
        <div class="col-md-3 mb-4">
          <h5>Follow Us</h5>
          <div class="social-links">
            <a href="#" class="text-white me-3"><i class="fab fa-facebook-f"></i></a>
            <a href="#" class="text-white me-3"><i class="fab fa-twitter"></i></a>
            <a href="#" class="text-white me-3"><i class="fab fa-instagram"></i></a>
            <a href="#" class="text-white"><i class="fab fa-linkedin-in"></i></a>
          </div>
        </div>
      </div>
      <hr class="my-4 bg-light">
      <div class="text-center">
        <p class="mb-0">&copy; 2023 GoPandaCars. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- Booking Modal -->
  <div class="modal fade" id="bookingModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Book <span id="modalCarName"></span></h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div id="loginRequired" class="text-center py-4">
            <h6>Please login to book this car</h6>
            <a href="login.html" class="btn btn-primary mt-3">Login</a>
          </div>
          <form id="bookingForm" style="display:none;">
            <div class="mb-3">
              <label class="form-label">Rental Option</label>
              <select class="form-select" id="rentalOption">
                <option value="12hrs">12 Hours (₹<span id="price12hrs"></span>)</option>
                <option value="24hrs">24 Hours (₹<span id="price24hrs"></span>)</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">Start Date</label>
              <input type="date" class="form-control" id="startDate" required>
            </div>
            <div class="mb-3">
              <label class="form-label">End Date</label>
              <input type="date" class="form-control" id="endDate" required>
            </div>
            <div class="alert alert-info">
              Estimated Total: ₹<span id="estimatedTotal">0</span>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" id="confirmBookingBtn" class="btn btn-primary" style="display:none;">Confirm Booking</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Firebase and Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
  
  <script>
    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyAJKgz1fONteZPPD5T9bcIVjw3-iBUZyro",
      authDomain: "gopandacars-7085f.firebaseapp.com",
      projectId: "gopandacars-7085f",
      storageBucket: "gopandacars-7085f.appspot.com",
      messagingSenderId: "486383420605"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Car data
   // In your cars array, replace image paths like this:
const cars = [
  {name:'Swift',image:'https://source.unsplash.com/random/300x200/?swift+car',price12hrs:1200,price24hrs:2000,description:'Compact hatchback...',category:'economy'},
  {name:'Etios',image:'https://source.unsplash.com/random/300x200/?toyota+etios',price12hrs:1200,price24hrs:2000,description:'Reliable sedan...',category:'economy'},
  // ... do this for all cars
];

    // DOM elements
    const authButtons = document.getElementById('authButtons');
    const userProfile = document.getElementById('userProfile');
    const userName = document.getElementById('userName');
    const logoutBtn = document.getElementById('logoutBtn');
    const bookingModal = new bootstrap.Modal(document.getElementById('bookingModal'));
    let selectedCar = null;

    // Check auth state
    auth.onAuthStateChanged(user => {
      if (user) {
        authButtons.style.display = 'none';
        userProfile.style.display = 'block';
        userName.textContent = user.email.split('@')[0];
        if (user.email === 'ramakrishnasaiganta@gmail.com') {
          // Add admin link if user is admin
          const dropdown = document.querySelector('.dropdown-menu');
          dropdown.innerHTML += `<li><a class="dropdown-item" href="admin.html"><i class="fas fa-cog me-1"></i>Admin Panel</a></li>`;
        }
      } else {
        authButtons.style.display = 'block';
        userProfile.style.display = 'none';
      }
    });

    // Logout handler
    logoutBtn.addEventListener('click', () => auth.signOut());

    // Render cars by category
    function renderCars() {
      const economyCars = cars.filter(car => car.category === 'economy');
      const premiumCars = cars.filter(car => car.category === 'premium');
      const luxuryCars = cars.filter(car => car.category === 'luxury');

      renderCarCategory(economyCars, 'economyCars');
      renderCarCategory(premiumCars, 'premiumCars');
      renderCarCategory(luxuryCars, 'luxuryCars');
    }

    function renderCarCategory(carList, elementId) {
      const container = document.getElementById(elementId);
      container.innerHTML = '';
      // Temporarily replace your cars array with just 1 car:
const cars = [
  {
    name: 'Test Car',
    image: 'https://source.unsplash.com/random/300x200/?car',
    price12hrs: 1000,
    price24hrs: 1800,
    description: 'Test description',
    category: 'economy'
  }
];

      carList.forEach((car, index) => {
        const card = document.createElement('div');
        card.className = 'col-md-4';
        card.innerHTML = `
          <div class="card car-card h-100">
            <img src="${car.image}" class="card-img-top" alt="${car.name}" style="height: 200px; object-fit: cover;">
            <div class="card-body">
              <h5 class="card-title">${car.name}</h5>
              <p class="card-text text-muted">${car.description}</p>
              <div class="d-flex justify-content-between align-items-center mb-2">
                <div>
                  <span class="fw-bold">₹${car.price12hrs}</span>/12h
                  <span class="mx-2">•</span>
                  <span class="fw-bold">₹${car.price24hrs}</span>/24h
                </div>
                <span class="badge bg-${getCategoryColor(car.category)} badge-category">${car.category}</span>
              </div>
              ${car.sunroof ? '<span class="badge bg-info me-1">Sunroof</span>' : ''}
              ${car.withDriver ? '<span class="badge bg-warning">With Driver</span>' : ''}
            </div>
            <div class="card-footer bg-transparent border-top-0">
              <button class="btn btn-primary w-100 book-btn" data-car-index="${index}">Book Now</button>
            </div>
          </div>
        `;
        container.appendChild(card);
      });

      // Add event listeners to book buttons
      document.querySelectorAll('.book-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const carIndex = this.getAttribute('data-car-index');
          showBookingModal(cars[carIndex]);
        });
      });
    }

    function getCategoryColor(category) {
      switch(category) {
        case 'economy': return 'success';
        case 'premium': return 'primary';
        case 'luxury': return 'danger';
        default: return 'secondary';
      }
    }

    function showBookingModal(car) {
      selectedCar = car;
      document.getElementById('modalCarName').textContent = car.name;
      document.getElementById('price12hrs').textContent = car.price12hrs;
      document.getElementById('price24hrs').textContent = car.price24hrs;
      
      const user = auth.currentUser;
      if (user) {
        document.getElementById('loginRequired').style.display = 'none';
        document.getElementById('bookingForm').style.display = 'block';
        document.getElementById('confirmBookingBtn').style.display = 'block';
        updateEstimatedTotal();
      } else {
        document.getElementById('loginRequired').style.display = 'block';
        document.getElementById('bookingForm').style.display = 'none';
        document.getElementById('confirmBookingBtn').style.display = 'none';
      }
      
      bookingModal.show();
    }

    function updateEstimatedTotal() {
      if (!selectedCar) return;
      
      const option = document.getElementById('rentalOption').value;
      const startDate = new Date(document.getElementById('startDate').value);
      const endDate = new Date(document.getElementById('endDate').value);
      
      if (isNaN(startDate) return;
      
      if (isNaN(endDate)) {
        // Single day booking
        const price = option === '12hrs' ? selectedCar.price12hrs : selectedCar.price24hrs;
        document.getElementById('estimatedTotal').textContent = price;
      } else {
        // Multi-day booking
        const days = Math.ceil((endDate - startDate) / (1000 * 60 * 60 * 24)) + 1;
        const pricePerDay = option === '12hrs' ? selectedCar.price12hrs : selectedCar.price24hrs;
        document.getElementById('estimatedTotal').textContent = days * pricePerDay;
      }
    }

    // Event listeners for booking form
    document.getElementById('rentalOption').addEventListener('change', updateEstimatedTotal);
    document.getElementById('startDate').addEventListener('change', updateEstimatedTotal);
    document.getElementById('endDate').addEventListener('change', updateEstimatedTotal);

    // Confirm booking
    document.getElementById('confirmBookingBtn').addEventListener('click', () => {
      const user = auth.currentUser;
      if (!user) return;
      
      const option = document.getElementById('rentalOption').value;
      const startDate = document.getElementById('startDate').value;
      const endDate = document.getElementById('endDate').value;
      const price = option === '12hrs' ? selectedCar.price12hrs : selectedCar.price24hrs;
      
      db.collection('bookings').add({
        userId: user.uid,
        userEmail: user.email,
        carId: selectedCar.name,
        carImage: selectedCar.image,
        startDate: startDate,
        endDate: endDate,
        rentalOption: option,
        price: price,
        status: 'pending',
        createdAt: firebase.firestore.FieldValue.serverTimestamp()
      }).then(() => {
        alert('Booking request submitted successfully!');
        bookingModal.hide();
      }).catch(error => {
        alert('Error submitting booking: ' + error.message);
      });
    });

    // Initialize the page
    renderCars();
  </script>
</body>
</html>
